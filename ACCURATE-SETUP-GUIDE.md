# 正確なサイト情報に基づくチャットボット - セットアップガイド

## 🎯 重要な改良点

このチャットボットは、実際のサイト情報のみを使用し、推測による回答を完全に排除した正確版です。

## 📊 実際のサイト調査結果

### ✅ 実際にサイトに記載されている情報
- **会社名**: とね屋（とね屋のお葬式）
- **電話番号**: 0120-000-000（24時間365日対応）
- **対応エリア**: 東京都、神奈川県
- **プラン種類**: 直葬/火葬式、家族葬、一日葬、一般葬、生活保護葬、自宅葬、社葬
- **宗教対応**: 仏式、神式、キリスト教、創価学会、無宗教

### ❌ サイトに記載されていない情報
- **具体的な料金**: 一切明記されていない
- **プランの詳細**: 含まれるサービス等の詳細なし
- **自社式場の詳細**: 名称、住所、設備等の情報なし
- **会社の基本情報**: 住所、代表者、設立年等なし
- **実際のFAQ**: FAQページが存在しない

## 🔧 セットアップ手順

### 1. 依存関係のインストール

```bash
cd funeral-chatbot
npm install
```

### 2. Gemini API Key の設定

```bash
# .env ファイルを作成
cp .env.example .env

# .env ファイルを編集
GEMINI_API_KEY=your_gemini_api_key_here
PORT=3000
```

### 3. 正確な知識データベースの使用

このバージョンでは `accurate-knowledge-base.json` を使用します：

```json
{
  "companyName": "とね屋（とね屋のお葬式）",
  "contact": {
    "phone": "0120-000-000",
    "businessHours": "24時間365日対応"
  },
  "pricing": {
    "generalInfo": "すべての料金は要問い合わせ",
    "description": "具体的な料金については、お電話でお問い合わせください"
  }
}
```

### 4. サーバーの起動

```bash
npm run dev
```

### 5. 正確版のテスト

ブラウザで `http://localhost:3000/test-accurate.html` にアクセス

## 🎯 正確な回答の例

### 料金に関する質問

**従来の回答（推測）:**
```
家族葬：500,000円〜1,000,000円
一日葬：300,000円〜600,000円
```

**正確な回答:**
```
申し訳ございませんが、当社の葬儀プランの料金については、
サイトに具体的な金額の記載がございません。

🔸 すべての料金は要問い合わせとなっております
🔸 無料でお見積もりを作成いたします

詳しい料金については、お電話（0120-000-000）にて
24時間365日承っております。
```

### 式場に関する質問

**従来の回答（推測）:**
```
豊島セレモニーホール（50名対応）
練馬セレモニーホール（80名対応）
```

**正確な回答:**
```
申し訳ございませんが、自社式場の詳細な情報については、
サイトに記載がございません。

📍 対応エリア
- 東京都（23区全体およびその他の地域）
- 神奈川県（横浜市、川崎市、相模原市など）

式場の詳細情報については、お電話（0120-000-000）にて
専門スタッフが丁寧にご案内いたします。
```

## 🛠️ 技術的な改良点

### 1. 知識データベースの正確性

```javascript
// 推測情報を明確に排除
{
  "price": "要問い合わせ",
  "details": "詳細はお問い合わせください",
  "facilities": {
    "info": "情報なし",
    "description": "自社式場の詳細については、お電話でお問い合わせください"
  }
}
```

### 2. AIプロンプトの改良

```javascript
const createPrompt = (userQuestion, knowledge) => {
  return `【重要な回答ガイドライン】
1. 提供された情報に記載されている内容のみを回答する
2. 推測や一般的な知識による回答は絶対に行わない
3. 料金については「要問い合わせ」であることを明確にする
4. 詳細情報がない場合は「詳細はお電話でお問い合わせください」と案内する
5. 「情報なし」と記載されている項目については、正直に情報がないことを伝える`;
};
```

### 3. フォールバック回答の正確性

```javascript
// 推測情報を排除したフォールバック
if (lowerQuestion.includes('料金')) {
  return `申し訳ございませんが、当社の葬儀プランの料金については、
サイトに具体的な金額の記載がございません。

🔸 すべての料金は要問い合わせとなっております`;
}
```

## 📈 メリット

### 1. 信頼性の向上
- 推測による誤情報の排除
- 実際のサイト情報のみを使用
- 透明性の確保

### 2. 適切な案内
- 詳細情報が必要な場合の電話相談への誘導
- 「要問い合わせ」の明確な案内
- 誠実な対応

### 3. 法的リスクの回避
- 誤った料金情報の提供を防止
- 不正確な情報による問題の回避
- 企業の信頼性保持

## 🔍 テスト方法

### 1. 料金に関するテスト

```javascript
// テスト質問
"家族葬の料金はいくらですか？"

// 期待される回答
"すべての料金は要問い合わせとなっております"
```

### 2. 式場に関するテスト

```javascript
// テスト質問
"式場の詳細を教えてください"

// 期待される回答
"自社式場の詳細な情報については、サイトに記載がございません"
```

### 3. プランに関するテスト

```javascript
// テスト質問
"家族葬に含まれるものは何ですか？"

// 期待される回答
"詳細はお電話（0120-000-000）でお問い合わせください"
```

## 🚀 本番環境での使用

### 1. 設定の確認

```bash
# 本番環境での設定
NODE_ENV=production
GEMINI_API_KEY=production_key
PORT=80
```

### 2. 既存サイトへの組み込み

```html
<script src="chatbot-widget-ai.js"></script>
<script>
  FuneralChatbotAI.init({
    apiUrl: 'https://your-api-domain.com/api/chat',
    welcomeMessage: '実際のサイト情報に基づいて、正確な情報をお答えいたします。',
    phoneNumber: '0120-000-000'
  });
</script>
```

## 📞 サポート

### 問題が発生した場合

1. `http://localhost:3000/api/health` でシステム状態を確認
2. `accurate-knowledge-base.json` の内容を確認
3. AIプロンプトが推測を避けるように設定されているか確認
4. 実際のサイト情報と回答内容が一致しているか確認

## 🔄 継続的な改善

### 1. 定期的なサイト確認

- 月1回のサイト情報チェック
- 新しい情報の追加
- 変更された情報の更新

### 2. 知識データベースの更新

- 実際のサイト情報の変更があった場合のみ更新
- 推測情報の混入を防ぐ
- 情報の出典を明確にする

### 3. 回答品質の監視

- 推測による回答がないかの定期チェック
- 不正確な情報の排除
- 適切な問い合わせ誘導の確認

---

## 🎉 結論

このチャットボットは、実際のサイト情報のみを使用することで、推測による誤情報を完全に排除し、信頼性の高い回答を提供します。情報が不明な場合は正直に案内し、適切に電話相談へ誘導することで、お客様に最適なサービスを提供できます。